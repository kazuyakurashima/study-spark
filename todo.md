# 📘 プロジェクト実装計画（改訂版）

## 🥇 優先度: 高（今ここ！）

- [x] **データベース設計 ✅ 完了**
  - StudySpark_DB_Spec.mdc にてテーブル構造確定済
  - ER図：Supabase Studioにて自動生成予定（Prisma反映後）

- [x] **Prismaによる Supabase DB セットアップ ✅ 完了**
  - [x] `.env` に `DATABASE_URL` を記述（Supabaseの接続情報）
  - [x] `schema.prisma` にテーブル定義を作成（設計仕様書に基づき全テーブル実装）
  - [x] `npx prisma db push` でSupabaseにテーブル作成
  - [x] `prisma/seed.js` にシードデータ作成（アバター、選択肢マスター、教材データ）
  - [x] `npx prisma db seed` でデータ投入完了

- [ ] **認証システムの実装（Supabase Auth）**
  - [ ] ログイン / ログアウト機能のフロントUI
  - [ ] ユーザー登録後、users テーブルにプロフィール同期（onboarding用）
  - [ ] 認証状態に応じたルーティング制御（未ログイン→ログイン画面へ）

- [ ] **オンボーディング完了フロー（初回ログイン時の案内）**
  - [ ] アバター選択 → ユーザー名登録 → onboarding_completed フラグ更新
  - [ ] フラグでガイド表示制御

---

## 🥈 優先度: 中（フロー全体をつなぐ）

- [ ] **トークルームUIの実装**
  - [ ] 3ステップチャットUI（ブレインダンプ / メタ認知 / ToDo）
  - [ ] 選択肢＋自由入力の両方に対応
  - [ ] 送信後の「進捗ゲージ」・褒めコメント演出

- [ ] **ChatGPT API 連携**
  - [ ] ローカルモック or テキスト定数で仮実装
  - [ ] `.env` 経由で `OPENAI_API_KEY` を安全に読み込み
  - [ ] 日次/週次の振り返りに対する GPT 応答を生成

- [ ] **メッセージ保存・取得（Supabase連携）**
  - [ ] daily_reflections / weekly_reflections テーブルへ保存処理
  - [ ] ユーザー別・日付別の履歴取得

- [ ] **グローバル状態管理**
  - [ ] Zustand or Context API にてユーザー・目標・学習進捗などを管理
  - [ ] トーク画面・ゴールナビ・スパーク機能間で共有

- [ ] **UIの磨き込み**
  - [ ] 進捗バー、正答率グラフなどの視覚化
  - [ ] カレンダーUI、切り替えアニメーションのUX向上

---

## 🥉 優先度: 低（完成度の底上げ）

- [ ] **コードリファクタリング**
  - [ ] ファイル構造の整理（`/features/`, `/entities/`, `/lib/`など導入）
  - [ ] 型定義の統一（Zod or TypeScript型でAPIバリデーション）
  - [ ] 共通処理やユーティリティの抽出
  - [ ] テストコード追加（`jest` or `vitest`）

---